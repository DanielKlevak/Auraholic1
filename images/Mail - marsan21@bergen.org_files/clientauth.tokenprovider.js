window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['clientauth.tokenprovider.js'] = (new Date()).getTime();
window.ClientAuth=window.ClientAuth||{},window.ClientAuth.tokenProvider=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(41)},function(e,t,n){var r,o;(function(n){/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0
	
	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.
	
	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
var i,u,a,c,s,l,f,d;!function(i){function u(e,t){return function(n,r){return e[n]=t?t(n,r):r}}var a="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:{};"object"==typeof System&&"function"==typeof System.register?System.register("tslib",[],function(e){return i(u(a,e)),{setters:[],execute:function(){}}}):(r=[t],o=function(e){i(u(a,u(e)))}.apply(t,r),!(void 0!==o&&(e.exports=o)))}(function(e){i=function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},c=function(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u},s=function(e,t){return function(n,r){t(n,r,e)}},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,a)}c((r=r.apply(e,t)).next())})},d=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){a.label=n[1];break}if(6===n[0]&&a.label<u[1]){a.label=u[1],u=n;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(n);break}u[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},e("__extends",i),e("__assign",u),e("__rest",a),e("__decorate",c),e("__param",s),e("__metadata",l),e("__awaiter",f),e("__generator",d)})}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){f=c.__assign({},l,e)}function o(){return f}function i(e){f.timezone=e}function u(e){f.useJsonNetSerializer=e}function a(e){var t=f.actionProxyEndpoints[e];return t?t:null}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),s={ApplyConversationAction:"messaging"},l={baseUrl:null,isServer:!1,isFeatureEnabled:function(e){return!1},actionProxyEndpoints:s},f=l;t.initializeServiceRequest=r,t.getConfig=o,t.setTimezone=i,t.setUseJsonNetSerializer=u,t.actionProxyPath=a},function(e,t,n){"use strict";function r(e){g=e}function o(e){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(n){switch(n.label){case 0:return t=a(c(),e),null!=t?[3,2]:[4,u(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:null]}})})}function i(e){var t=a(c(),e);return null!=t?[t.AccessToken,null]:[null,u(e).then(function(e){return e.AccessToken})]}function u(e){return s.__awaiter(this,void 0,void 0,function(){var t,n;return s.__generator(this,function(r){switch(r.label){case 0:return[4,p.default(e)];case 1:return t=r.sent(),null!=t&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(n=f(t.AccessTokenExpiry,Date.now())-h,n>0&&c().put(e,t,n,function(e,t){u(e)})),[2,t]}})})}function a(e,t){var n=e.get(t),r=null;if(null!=n&&null!=n.AccessTokenExpiry){var o=l(n.AccessTokenExpiry,v);o>new Date(Date.now())&&(r=n)}return r}function c(){return null==g&&(g=new d.Cache),g}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=n(18),f=n(6),d=n(4),p=n(38),v=1,h=7200,g=null;t.initializeTokenProvider=r,t.getAccessTokenforResource=o,t.getAccessTokenforResourceAsLazy=i,t.fetchAndCacheTokenFromServer=u,t.getCachedToken=a},function(e,t){"use strict";function n(){function e(e){o--,delete t[e]}var t=Object.create(null),n=0,r=0,o=0,i=!1;this.put=function(n,r,i,u){if("undefined"!=typeof i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if("undefined"!=typeof u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var a=t[n];a?clearTimeout(a.timeout):o++;var c={value:r,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){e(n),u&&u(n,r)}.bind(this),i)),t[n]=c,r},this.del=function(n){var r=!0,o=t[n];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(r=!1)):r=!1,r&&e(n),r},this.clear=function(){for(var e in t)clearTimeout(t[e].timeout);o=0,t=Object.create(null),i&&(n=0,r=0)},this.get=function(e){var u=t[e];if("undefined"!=typeof u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&n++,u.value;i&&r++,o--,delete t[e]}else i&&r++;return null},this.size=function(){return o},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(e){i=e},this.hits=function(){return n},this.misses=function(){return r},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),o=Date.now(),i=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(i){var a=t[u];if(a)continue}var c=r[u],s=c.expire-o;if(s<=0){this.del(u);continue}s=s>0?s:void 0,this.put(u,c.value,s)}return this.size()}}e.exports=new n,e.exports.Cache=n},function(e,t,n){function r(e,t){var n=o(e).getTime(),r=Number(t);return new Date(n+r)}var o=n(7);e.exports=r},function(e,t,n){function r(e,t){var n=o(e),r=o(t);return n.getTime()-r.getTime()}var o=n(7);e.exports=r},function(e,t,n){function r(e,t){if(l(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=t||{},r=n.additionalDigits;r=null==r?p:Number(r);var s=o(e),f=i(s.date,r),v=f.year,h=f.restDateString,g=u(h,v);if(g){var y,m=g.getTime(),_=0;return s.time&&(_=a(s.time)),s.timezone?y=c(s.timezone):(y=new Date(m+_).getTimezoneOffset(),y=new Date(m+_+y*d).getTimezoneOffset()),new Date(m+_+y*d)}return new Date(e)}function o(e){var t,n={},r=e.split(v);if(h.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var o=R.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}function i(e,t){var n,r=y[t],o=_[t];if(n=m.exec(e)||o.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=g.exec(e)||r.exec(e)){var u=n[1];return{year:100*parseInt(u,10),restDateString:e.slice(u.length)}}return{year:null}}function u(e,t){if(null===t)return null;var n,r,o,i;if(0===e.length)return r=new Date(0),r.setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=w.exec(e)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(t,0,u),r}if(n=C.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var a=parseInt(n[2],10);return r.setUTCFullYear(t,o,a),r}if(n=k.exec(e))return i=parseInt(n[1],10)-1,s(t,i);if(n=A.exec(e)){i=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return s(t,i,c)}return null}function a(e){var t,n,r;if(t=O.exec(e))return n=parseFloat(t[1].replace(",",".")),n%24*f;if(t=x.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*f+r*d;if(t=T.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*f+r*d+1e3*o}return null}function c(e){var t,n;return(t=P.exec(e))?0:(t=j.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=U.exec(e),t?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0)}function s(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=r.getUTCDay()||7,i=7*t+n+1-o;return r.setUTCDate(r.getUTCDate()+i),r}var l=n(17),f=36e5,d=6e4,p=2,v=/[T ]/,h=/:/,g=/^(\d{2})$/,y=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],m=/^(\d{4})/,_=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,w=/^-?(\d{3})$/,C=/^-?(\d{2})-?(\d{2})$/,k=/^-?W(\d{2})$/,A=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,T=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,R=/([Z+-].*)$/,P=/^(Z)$/,j=/^([+-])(\d{2})$/,U=/^([+-])(\d{2}):?(\d{2})$/;e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r=u.getConfig(),o=c.default(),i=u.actionProxyPath(e),p=null!=i&&r.isFeatureEnabled("fwk-proxyActionsToOwsGateway")&&null!=r.getAuthTokenAsync,v=p?r.primeUrl?r.primeUrl+"/"+i+"/service.svc?action=":"/ows/messaging/service.svc?action=":r.baseUrl?r.baseUrl+"/service.svc?action=":"/owa/service.svc?action=";n&&(o=f.default(o,n)),void 0!==r.isUserIdle&&r.isUserIdle()&&(o.isUserActivity=!1);var h=o.headers;h.append("Content-Type","application/json; charset=utf-8"),h.append("Action",e);var g=v+e;void 0!==o.isUserActivity&&0==o.isUserActivity&&(g+="&UA=0");var y=JSON.stringify(t),m=encodeURIComponent(y);if(m.length>d?o.body=y:(g+="&EP=1",h.append("X-OWA-UrlPostData",m),o.body=null),!h.has(a.correlationVectorHeaderName)){var _=a.getCorrelationVector();_&&h.append(a.correlationVectorHeaderName,_)}r.appName&&(g+="&app="+r.appName);var b=1;if(p){var w=r.getAuthTokenAsync(l.default()),C=w[0],k=w[1];return C?(h.append("Authorization","Bearer "+C),s.default(g,b,o)):k.then(function(e){return h.append("Authorization","Bearer "+e),s.default(g,b,o)})}return s.default(g,b,o)}function o(e,t){var n="";return t&&(n="",Object.keys(t).map(function(e){n+=e+"="+t[e]+"&"})),"service.svc/s/"+e+"?"+n+"X-OWA-CANARY="+i.getOwaCanaryCookie()}Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),u=n(2),a=n(21),c=n(22),s=n(24),l=n(25),f=n(29),d=2048;t.makeServiceRequest=r,t.getActionUrl=o},function(e,t,n){"use strict";function r(){var e=i.getCookie("targetServer"),t="X-OWA-CANARY"+(e?"_"+e.toLocaleLowerCase():""),n=i.getCookie(t);return n&&0!=n.length?n:t+"_cookie_is_null_or_empty"}function o(){var e=i.getCookie("targetServer"),t="X-OWA-CANARY-DEBUG"+(e?"_"+e.toLocaleLowerCase():""),n=i.getCookie(t);return n}Object.defineProperty(t,"__esModule",{value:!0});var i=n(13);t.getOwaCanaryCookie=r,t.getOwaCanaryDebugCookie=o},function(e,t,n){"use strict";function r(e){var t=o.__assign({__type:"TokenRequest:#Exchange"},e);return t}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.default=r},function(e,t,n){"use strict";function r(e){return o.makeServiceRequest("GetAuthenticationUrl",{},e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(8);t.default=r},function(e,t,n){"use strict";function r(e){e.set("X-OWA-CANARY",o.getOwaCanaryCookie());var t=o.getOwaCanaryDebugCookie();t&&e.set("X-OWA-CANARY-DEBUG",t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(9);t.default=r},function(e,t,n){"use strict";function r(e){return i.getConfig().cookies?i.getConfig().cookies[e]:u.get(e)}function o(){var e;if(e=i.getConfig().cookies?i.getConfig().cookies:u.get()){var t=Object.keys(e);if(t&&t.length>0)return t.map(function(t){return t+"="+e[t]}).join("; ")}return null}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),u=n(19);t.getCookie=r,t.getCookieHeaderValue=o},function(e,t,n){"use strict";t.decode=t.parse=n(33),t.encode=t.stringify=n(34)},function(e,t,n){function r(e,t){var n=Number(t);return o(e,n*i)}var o=n(5),i=6e4;e.exports=r},function(e,t,n){function r(e,t){var n=Number(t);return o(e,1e3*n)}var o=n(5);e.exports=r},function(e,t){function n(e){return e instanceof Date}e.exports=n},function(e,t,n){function r(e,t){var n=Number(t);return o(e,-n)}var o=n(15);e.exports=r},function(e,t,n){var r,o;!function(i){var u=!1;if(r=i,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o)),u=!0,e.exports=i(),u=!0,!u){var a=window.Cookies,c=window.Cookies=i();c.noConflict=function(){return window.Cookies=a,c}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var u;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},r.defaults,i),"number"==typeof i.expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}try{u=JSON.stringify(o),/^[\{\[]/.test(u)&&(o=u)}catch(e){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}t||(u={});for(var c=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var f=c[l].split("="),d=f.slice(1).join("=");'"'===d.charAt(0)&&(d=d.slice(1,-1));try{var p=f[0].replace(s,decodeURIComponent);if(d=n.read?n.read(d,p):n(d,p)||d.replace(s,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(t===p){u=d;break}t||(u[p]=d)}catch(e){}}return u}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})},function(e,t,n){"use strict";function r(e,t){o.default(t),t.set(i,""+e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),i="X-OWA-Attempt";t.default=r},function(e,t){"use strict";function n(){return d.concat(".",p.toString())}function r(){var e=n();return c(e)?e:""}function o(){var e=n();return!!c(e)&&a(d.length+1+(p+1+"").length)}function i(){for(var e="",t=0;t<f.baseLength;t++)e+=l.charAt(Math.floor(Math.random()*l.length));return e}function u(){return o()?(p+=1,n()):null}function a(e){return e<=f.maxCorrelationVectorLength}function c(e){return f.validationPattern.test(e)&&e.length<=f.maxCorrelationVectorLength}function s(){return c(n())?u():(d=i(),p=0,r())}Object.defineProperty(t,"__esModule",{value:!0}),t.correlationVectorHeaderName="MS-CV";var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f={maxCorrelationVectorLength:127,baseLength:22,validationPattern:new RegExp("^["+l+"]{22}(.[0-9]+)+$")},d="",p=0;t.isCorrelationVectorValid=c,t.getCorrelationVector=s},function(e,t,n){"use strict";function r(){var e=new Headers;o.default(e);var t=u.getConfig();if(t.getAuthToken){var n=t.getAuthToken();n&&e.append("Authorization","Bearer "+n)}if(t.appName&&e.append("X-Req-Source",t.appName),t.useJsonNetSerializer&&e.append("X-UseJsonNetSerializer","1"),t.isServer){var r=i.getCookieHeaderValue();r&&e.append("Cookie",r)}return{method:"POST",credentials:"include",headers:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),i=n(13),u=n(2);t.default=r},function(e,t,n){"use strict";function r(e,t){return i(e,t)?e.json().catch(function(e){throw u(e)}):null}function o(e,t){return i(e,t)?Promise.resolve(e):null}function i(e,t){if(401==e.status||440==e.status){if(a.getConfig().onAuthNeeded&&!s.default(t))return a.getConfig().onAuthNeeded(),!1}else if(!e.ok){if(412==e.status&&a.getConfig().onHipChallengeNeeded&&a.getConfig().onHipChallengeNeeded(e.headers))return!1;var n=u(e.statusText);throw n.response=e,n}return null!=e.headers.get("X-OWA-STO")&&c.tryBackgroundAuth(window),!0}function u(e){var t=new Error(""+e);return t.fetchErrorType="ServerFailure",t.knownError=!0,t}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),c=n(32),s=n(26);t.fetchJsonHandler=r,t.fetchFullResponseHandler=o},function(e,t,n){"use strict";function r(e){var t=f++;return d[t]=e,function(){delete d[t]}}function o(e,t,n){for(var r=i.default(e,n),f=Object.keys(d),p=0;p<f.length;p++)d[f[p]](r,e,t,n);return r.then(function(r){return a.default(r.status)&&t<s?(c.default(++t,n.headers),o(e,t,n)):n.returnFullResponseOnSuccess?u.fetchFullResponseHandler(r,n):u.fetchJsonHandler(r,n)},function(r){if(r.retriable&&t<s)return new Promise(function(r,i){setTimeout(function(){c.default(++t,n.headers),r(o(e,t,n))},l)});throw r})}Object.defineProperty(t,"__esModule",{value:!0});var i=n(31),u=n(23),a=n(27),c=n(20),s=2,l=5e3,f=0,d={};t.registerCreateServiceResponseCallback=r,t.default=o},function(e,t){"use strict";function n(){return window.location.origin}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){if(e){var t=e.headers;if(t&&null!=t.get("X-OWA-ExplicitLogonUser"))return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e){return 449==e||408==e||502==e||e<100||e>599}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e,t){return void 0===e||e.__type||(e=i.default(e)),o.makeServiceRequest("GetAccessTokenforResource",e,t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),i=n(10);t.default=r},function(e,t,n){"use strict";function r(e,t){return e&&u[t]}function o(e,t){var n=i.__assign({},e);if(t.headers){var o=new Headers(t.headers),u=new Headers(n.headers);o.forEach(function(e,t){u.set(t,e)}),n.headers=u}if(t.returnFullResponseOnSuccess&&(n.returnFullResponseOnSuccess=t.returnFullResponseOnSuccess),void 0!==t.isUserActivity&&(n.isUserActivity=t.isUserActivity),n.method=t.method||n.method,!Object.keys(t).reduce(r,!0))throw"Only headers and method are allowed to be overridden";return n}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),u={method:!0,headers:!0,returnFullResponseOnSuccess:!0,isUserActivity:!0};t.default=o},function(e,t){"use strict";function n(e){if(o)throw new Error("Calls to prefetch() may not be nested.");try{o=!0,e()}finally{o=!1}}function r(){return o}Object.defineProperty(t,"__esModule",{value:!0});var o=!1;t.default=n,t.isInPrefetchMode=r},function(e,t,n){"use strict";function r(e,t){return i.isInPrefetchMode()?new Promise(function(n,r){u.push({url:e,init:t,resolve:n,reject:r}),o()}):fetch(e,t).catch(function(t){return t.message&&(t.message=t.message+". URL: "+e),t.retriable=!0,t.fetchErrorType="RequestNotComplete",Promise.reject(t)})}function o(){if(!a&&u.length){a=!0;var e=u.shift();fetch(e.url,e.init).then(function(t){a=!1,e.resolve(t),o()},function(t){a=!1,e.reject(t),o()})}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(30),u=[],a=!1;t.default=r},function(e,t,n){"use strict";function r(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return null!=d?[2]:null!=p&&Date.now()-p<s?[2]:(p=Date.now(),v=e,d=v.document.createElement("iframe"),d.setAttribute("id",f),d.style.display="none",c.default().then(function(e){return 0!=e.ResultCode||null==e.AuthenticationUrl||""==e.AuthenticationUrl?void(d=null):(v.document.body.appendChild(d),v.addEventListener("message",i,!1),d.src=e.AuthenticationUrl,void o())}).catch(function(e){d=null}),[2])})})}function o(){setTimeout(function(){null!=d&&u()},l)}function i(e){if(e.origin==v.location.origin&&e.data&&e.data.split){var t=e.data.split(":")[0];"backgroundAuthResponse"==t&&u()}}function u(){v.document.body.removeChild(d),d=null,v.document.removeEventListener("message",i)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),c=n(11),s=828e5,l=6e4,f="backgroundauth",d=null,p=null,v=null;t.tryBackgroundAuth=r},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var u=/\+/g;e=e.split(t);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var s=0;s<c;++s){var l,f,d,p,v=e[s].replace(u,"%20"),h=v.indexOf(r);h>=0?(l=v.substr(0,h),f=v.substr(h+1)):(l=v,f=""),d=decodeURIComponent(l),p=decodeURIComponent(f),n(i,d)?Array.isArray(i[d])?i[d].push(p):i[d]=[i[d],p]:i[d]=p}return i}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(n(o))+r;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(n(e))}).join(t):i+encodeURIComponent(n(e[o]))}).join(t):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(e)):""}},function(e,t,n){"use strict";function r(e){i||(o.bootstrapServiceRequest(e),i=!0)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(36),i=!1;t.bootstrap=r},function(e,t,n){"use strict";function r(e){var t=e&&e.location?e.location.pathname:null,n=i.getIndexedPath("/owa",t);o.initializeServiceRequest({baseUrl:n})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(40);t.bootstrapServiceRequest=r},function(e,t,n){"use strict";function r(e){return c.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return c.__generator(this,function(a){switch(a.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),r={},a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,o(e,window)];case 2:return r=a.sent(),[3,5];case 3:return i=a.sent(),r.TokenResultCode=2,[3,5];case 4:return u(n,window),[7];case 5:return[2,r]}})})}function o(e,t){return c.__awaiter(this,void 0,void 0,function(){var n,r,o;return c.__generator(this,function(u){return n=encodeURIComponent(e.client_id+e.scope),r=a(e),o=null,null==t.document.getElementById(n)?(o=t.document.createElement("iframe"),o.src=r.toString(),o.style.display="none",o.id=n,t.document.body.appendChild(o),[2,new Promise(function(e,r){f[n]=function(n){var o={};try{this.contentWindow.location.origin==t.location.origin&&(o=i(this.contentWindow.location.hash.substring(1)))}catch(e){o.TokenResultCode=2,r(o)}e(o)},o.addEventListener("load",f[n],!1)})]):[2,{TokenResultCode:2}]})})}function i(e){var t=l.parse(e),n={};return t.access_token?(n.AccessToken=t.access_token,n.AccessTokenExpiry=s(Date.now(),parseInt(t.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==t.error||"interaction_required"==t.error||"consent_required"==t.error?n.TokenResultCode=3:n.TokenResultCode=2,n}function u(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}function a(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+l.stringify(t)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),s=n(16),l=n(14),f={};t.fetchDelegationAccessTokenFromMsa=r,t.ParseHashParam=i,t.getAuthenticationUrl=a},function(e,t,n){"use strict";function r(e){return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(n){return t={isUserActivity:!1},[2,u.default(i.default({Resource:e}),t)]})})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(10),u=n(28);t.default=r},function(e,t,n){"use strict";function r(e){return c.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return c.__generator(this,function(u){switch(u.label){case 0:return t={scope:e,client_id:"",authorization_uri:"",redirect_uri:""},n=null,[4,d.default()];case 1:return r=u.sent(),0!=r.ResultCode||null==r.ImplicitGrantAuthorizationUrl||""==r.ImplicitGrantAuthorizationUrl?[2,n]:(i=f.parse(r.ImplicitGrantAuthorizationUrl.split("?")[1]||""),i.client_id&&i.redirect_uri?(t.client_id=i.client_id,t.authorization_uri=r.ImplicitGrantAuthorizationUrl.split("?")[0],t.redirect_uri=i.redirect_uri,[4,o(t)]):[3,3]);case 2:n=u.sent(),u.label=3;case 3:return[2,n]}})})}function o(e){return c.__awaiter(this,void 0,void 0,function(){var t,n;return c.__generator(this,function(r){switch(r.label){case 0:return t=e.client_id+e.scope,n=p.getCachedToken(a(),t),null!=n?[3,2]:[4,v.fetchDelegationAccessTokenFromMsa(e)];case 1:n=r.sent(),i(t,n),r.label=2;case 2:return[2,0==n.TokenResultCode?n.AccessToken:null]}})})}function i(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=s(t.AccessTokenExpiry,Date.now());n>0&&a().put(e,t,n)}}function u(e){h=e}function a(){return null==h&&(h=new l.Cache),h}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),s=n(6),l=n(4),f=n(14),d=n(11),p=n(3),v=n(37),h=null;t.getDelegationTokenForOwa=r,t.getDelegationToken=o,t.cacheToken=i,t.initializeTokenProvider=u},function(e,t){"use strict";function n(e,t){var n=e;if(t){var r=t.split("/").filter(function(e){return e.length});if(r.length>=2){var o=parseInt(r[1]);isNaN(o)||(n+="/"+o)}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getIndexedPath=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.registerTokenProvider=r.default;var o=n(3);t.getAccessTokenforResource=o.getAccessTokenforResource;var i=n(3);t.getAccessTokenforResourceAsLazy=i.getAccessTokenforResourceAsLazy;var u=n(39);t.getDelegationToken=u.getDelegationToken,t.getDelegationTokenForOwa=u.getDelegationTokenForOwa;var a=n(35);t.bootstrap=a.bootstrap},function(e,t,n){"use strict";function r(e){i.initializeTokenProvider(new o.Cache),i.getAccessTokenforResource(e.location.origin)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(3);t.default=r}]);
//# sourceMappingURL=clientauth.tokenProvider.js.map;
window.scriptsLoaded['clientauth.tokenprovider.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['clientauth.tokenprovider.js'] = (new Date()).getTime();
